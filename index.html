<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سوق باي - souq-pi-app</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            transition: direction 0.3s;
        }
        header {
            background-color: #333;
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        nav ul {
            list-style: none;
            display: flex;
            gap: 20px;
            padding: 0;
        }
        nav a {
            color: white;
            text-decoration: none;
        }
        .lang-switch button {
            padding: 8px 15px;
            cursor: pointer;
            background-color: #f39c12;
            border: none;
            color: white;
            border-radius: 5px;
            font-weight: bold;
        }
        .content {
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>

<header>
    <div class="logo">
        <h2 id="site-title">سوق باي</h2>
    </div>
    
    <nav>
        <ul>
            <li><a href="index.html" id="nav-home">الرئيسية</a></li>
            <li><a href="projects.html" id="nav-projects">المشاريع</a></li>
            <li><a href="blog.html" id="nav-blog">المدونة</a></li>
            <li><a href="cv.html" id="nav-cv">السيرة الذاتية</a></li>
        </ul>
    </nav>

    <div class="lang-switch">
        <button id="lang-btn" onclick="toggleLanguage()">English</button>
    </div>
</header>

<div class="content">
    <h1 id="welcome-msg">مرحباً بك في تطبيق سوق باي</h1>
    <p id="description">هذا هو المجلد الرئيسي للمشروع بعد تنظيم الملفات.</p>
    <img src="iphone.jpg" alt="iPhone" style="max-width: 200px; margin-top: 20px;">
</div>

<script>
    function toggleLanguage() {
        const htmlTag = document.documentElement;
        const btn = document.getElementById('lang-btn');
        
        // العناصر المراد تغيير نصوصها
        const title = document.getElementById('site-title');
        const home = document.getElementById('nav-home');
        const projects = document.getElementById('nav-projects');
        const blog = document.getElementById('nav-blog');
        const cv = document.getElementById('nav-cv');
        const welcome = document.getElementById('welcome-msg');
        const desc = document.getElementById('description');

        if (htmlTag.dir === "rtl") {
            // التحويل للإنجليزية
            htmlTag.dir = "ltr";
            htmlTag.lang = "en";
            btn.innerText = "العربية";
            
            // تغيير النصوص للإنجليزية
            title.innerText = "Souq Pi";
            home.innerText = "Home";
            projects.innerText = "Projects";
            blog.innerText = "Blog";
            cv.innerText = "CV";
            welcome.innerText = "Welcome to Souq Pi App";
            desc.innerText = "This is the root directory after organizing the files.";
        } else {
            // العودة للعربية
            htmlTag.dir = "rtl";
            htmlTag.lang = "ar";
            btn.innerText = "English";
            
            // إعادة النصوص للعربية
            title.innerText = "سوق باي";
            home.innerText = "الرئيسية";
            projects.innerText = "المشاريع";
            blog.innerText = "المدونة";
            cv.innerText = "السيرة الذاتية";
            welcome.innerText = "مرحباً بك في تطبيق سوق باي";
            desc.innerText = "هذا هو المجلد الرئيسي للمشروع بعد تنظيم الملفات.";
        }
    }
</script>
<button id="pay-button" style="padding: 15px 30px; background-color: #f39c12; color: white; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; display: block; margin: 20px auto;">
  شراء المنتج (1 Pi)
</button>

<script src="https://sdk.minepi.com/pi-sdk.js"></script>

<script>
  const Pi = window.Pi;
  // تأكد أن sandbox: false إذا كنت تريد تجربة دفع حقيقية
  Pi.init({ version: "2.0", sandbox: true }); 

  document.getElementById('pay-button').onclick = async function() {
    try {
      const payment = await Pi.createPayment({
        amount: 1,
        memo: "طلب شراء من سوق باي",
        metadata: { productId: "pi-item-001" }
      }, {
        onReadyForServerApproval: (paymentId) => {
          // هذا يرسل المعرف لملف الـ api الذي أنشأته في Vercel
          return fetch('/api', { 
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ paymentId })
          });
        },
        onReadyForServerCompletion: (paymentId, txid) => {
          alert("تمت عملية الدفع بنجاح! رقم العملية: " + txid);
        },
        onCancel: (paymentId) => { console.log("تم إلغاء الدفع"); },
        onError: (error, payment) => { console.error("خطأ في الدفع: ", error); }
      });
    } catch (err) {
      console.error("عطل في النظام: ", err);
    }
  };
</script>


</body>
</html>
