Pi.init({ version: "2.0", sandbox: false }); // الإنتاج الحقيقي

const payment = await Pi.createPayment({
    amount: 1,
    memo: "إتمام الخطوة 10",
    metadata: { productId: "step-10" }
}, {
    onReadyForServerApproval: (paymentId) => {
        // هذا هو السطر الذي يمنع الـ Timeout
        return fetch('/api/index', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ paymentId })
        });
    },
    onReadyForServerCompletion: (paymentId, txid) => {
        alert("مبروك! اكتملت الخطوة 10 بنجاح");
    },
    onCancel: (paymentId) => { console.log("إلغاء"); },
    onError: (error) => { alert("خطأ: " + error.message); }
});
