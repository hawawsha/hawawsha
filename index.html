<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<script>
    // تهيئة التطبيق للعمل داخل متصفح Pi
    Pi.init({ 
        version: "2.0", 
        sandbox: true 
    });

    // دالة الدفع التجريبي (ستعمل عند الضغط على أزرار الإضافة في موقعك)
    async function add(price) {
        try {
            const payment = await Pi.createPayment({
                amount: price,
                memo: "تجربة شراء من سوق هوواشة",
                metadata: { productId: "item-123" }
            }, {
                onReadyForServerApproval: (paymentId) => {
                    console.log("تم تجهيز الدفع: " + paymentId);
                },
                onReadyForServerCompletion: (paymentId, txid) => {
                    console.log("تمت العملية بنجاح: " + txid);
                    alert("شكراً لك! تمت العملية التجريبية بنجاح.");
                },
                onCancel: (paymentId) => { console.log("تم إلغاء الدفع"); },
                onError: (error, payment) => { console.error("خطأ:", error); }
            });
        } catch (err) {
            console.error(err);
        }
    }
</script>
